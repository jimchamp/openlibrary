$def with (page)

$ _x = ctx.setdefault('cssfile', 'edit')

$var title: $_("Edit %(title)s", title=page.title or page.key)

$code:
    def show_macro_picker():
        if not ctx.path.startswith("/collections/"):
            return False
        return ctx.user and (ctx.user.is_beta_tester() or ctx.user.is_admin())

$:render_template("lib/edit_head", page)
<div id="contentBody">

    <form name="edit" method="post" action="" class="olform">

    <div class="formElement title">
        <input type="hidden" name="type.key" value="$page.type.key" />

        <div class="label"><label for="title">$_("Title"):</label></div>
        <div class="input">
            <input type="text" name="title" value="$page.title" />
        </div>
    </div>

    $:macros.TypeChanger(page.type)

    <div class="clearfix"></div>

    <div class="formElement">
        <div class="label"><label for="body">$_('Document Body:')</label></div>
        $ textarea_id = "body"
        $if show_macro_picker():
            $:render_template("macro_picker", textarea_id)
        <div class="input">
            <textarea id="body" name="$textarea_id" class="markdown" rows="15" cols="80">$page.body</textarea>
        </div>
    </div>

    $:macros.EditButtons(comment=page.comment_)

    </form>
</div>
