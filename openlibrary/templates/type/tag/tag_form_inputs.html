$def with (tag_name='', tag_type='', tag_description='', show_type_picker=True)

<div class="formElement">
    <div class="label">
        <label for="tag_name">$_("Tag Name")</label>*<span class="tip">$_("Required field")</span>
    </div>
    <div class="input">
        <input type="text" name="name" id="tag_name" value="$tag_name" required/>
    </div>
</div>

<fieldset class="major">
    <div class="formElement">
        <div class="label">
            <label for="tag_description">$_("Tag Description")</label>
        </div>
        <div class="input">
            <textarea id="tag_description" name="tag_description" rows="5" cols="80">$tag_description</textarea>
        </div>
    </div>
</fieldset>

$if show_type_picker:
    <div class="formElement">
        <div class="label"><label for="tag_type">$_("Tag type")</label></div>
        <div class="input">
            <select name="tag_type" id="tag_type" required>
                <option value="">$_("Select")</option>
                $ tag_types = get_tag_types()
                $for t_type in tag_types:
                    $if t_type == tag_type:
                        <option value="$t_type" selected>$t_type</option>
                    $else:
                        <option value="$t_type">$t_type</option>
            </select>
        </div>
    </div>
    <div class="sub-type-inputs">
        <div class="sub-type-inputs__input-set hidden" data-input-type="subject">
            $:render_template("type/tag/subject/edit_form_inputs")
        </div>
        <div class="sub-type-inputs__input-set hidden" data-input-type="collection">
            $:render_template("type/tag/collection/edit_form_inputs")
        </div>
    </div>

    <script>
        const SUBJECT_TYPES = ["subject", "person", "place", "time"]
        const tagTypeSelector = document.querySelector('#tag_type')
        const subTypeInputs = document.querySelectorAll(".sub-type-inputs__input-set")
        const inputSetMapping = {}

        function initTagTypeSelector(selector) {
            subTypeInputs.forEach((input) => {
                inputSetMapping[input.dataset.inputType] = input
            })

            selector.addEventListener("change", (event) => {
                const selectedValue = event.target.value
                let selectedType
                if (SUBJECT_TYPES.includes(selectedValue)) {
                    selectedType = 'subject'
                } else {
                    selectedType = selectedValue
                }

                hideSubTypeInputs()
                if (selectedType) {
                    showSubTypeInputs(selectedType)
                }
            })
        }

        function hideSubTypeInputs() {
            subTypeInputs.forEach((input) => {
                input.classList.add('hidden')
            })
        }

        function showSubTypeInputs(inputsToShow) {
            inputSetMapping[inputsToShow].classList.remove('hidden')
        }

        initTagTypeSelector(tagTypeSelector)
    </script>
